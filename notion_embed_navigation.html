<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Notion Photo Navigation</title>
    <!-- Tailwind CSSã‚’èª­ã¿è¾¼ã¿ -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* ã‚«ã‚¹ã‚¿ãƒ ã‚¹ã‚¿ã‚¤ãƒ«: è¦ç´ ã‚’ç”»é¢å…¨ä½“ã«åºƒã’ã€Notionã®åŸ‹ã‚è¾¼ã¿ã«æœ€é©åŒ–ã™ã‚‹ */
        body, html {
            height: 100%;
            margin: 0;
            padding: 0;
            overflow: hidden; /* Notionã®åŸ‹ã‚è¾¼ã¿ã§äºŒé‡ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ãƒãƒ¼ã‚’é˜²ã */
            font-family: 'Inter', sans-serif;
            background-color: #1f2937; /* ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã®èƒŒæ™¯ã«åˆã‚ã›ã‚‹ */
            color: #f3f4f6;
        }
        #app-container {
            display: flex;
            flex-direction: column;
            height: 100%;
            width: 100%;
        }
        #navigation-bar {
            flex-shrink: 0;
        }
        #iframe-container {
            flex-grow: 1; /* iframeã‚³ãƒ³ãƒ†ãƒŠãŒåˆ©ç”¨å¯èƒ½ãªã‚¹ãƒšãƒ¼ã‚¹ã‚’ã™ã¹ã¦å ã‚ã‚‹ */
            position: relative;
            /* Notionå´ã®èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’éè¡¨ç¤ºã«ã™ã‚‹ãŸã‚ã«èƒŒæ™¯ã‚’ç™½ã«ã—ã¦ãŠã */
            background-color: #ffffff; 
        }
        #notion-iframe {
            width: 100%;
            height: 100%;
            border: none;
        }
        /* ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªãƒœã‚¿ãƒ³ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .btn-active {
            background-color: #4f46e5 !important;
            color: white !important;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>
<body class="bg-gray-800 text-gray-100">

    <div id="app-container">

    <div id="common-header" class="p-4 bg-gray-900 border-b border-gray-700 shadow-lg flex justify-between items-center">
        <h1 id="app-title" class="text-xl font-bold">ğŸ“¸ Photo Album System</h1>
        <button id="back-button" class="bg-gray-700 hover:bg-gray-600 py-1 px-3 rounded-lg hidden" onclick="goBack()">
            &larr; æˆ»ã‚‹
        </button>
    </div>

    <div id="main-content" class="flex-grow overflow-auto p-4">
        
        <div id="view-1-category" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            </div>

        <div id="view-2-tag" class="hidden grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
            </div>

        <div id="view-3-embed" class="hidden w-full h-full">
            </div>

    </div>

</div>

    <script>
        // =================================================================
        // ãƒ¦ãƒ¼ã‚¶ãƒ¼è¨­å®šã‚¨ãƒªã‚¢
        // =================================================================

        // 1. Notionã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹IDã‚’è¨­å®šã—ã¦ãã ã•ã„ã€‚
        // å…ƒã®URL: https://mint-headlight-c47.notion.site/e3dfdc3f07e746af9076ecafd868f02f
        // ãƒšãƒ¼ã‚¸IDã®ã¿ã‚’æŠ½å‡º: e3dfdc3f07e746af9076ecafd868f02f
        const NOTION_BASE_URL = "https://mint-headlight-c47.notion.site/ebd/e3dfdc3f07e746af9076ecafd868f02f"; 

        const VIEW_MAP = {
            // ã€é‡è¦ã€‘ã€Œã™ã¹ã¦ã€ãƒœã‚¿ãƒ³ãŒæŒ‡ã™ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ“ãƒ¥ãƒ¼ã®ID
            "all": "5cbfc69b6d6a4eadbdae06703ffe9b4f", 
             // Notionã§æ–°ã—ãä½œæˆã—ãŸãƒ•ã‚£ãƒ«ã‚¿æ¸ˆã¿ãƒ“ãƒ¥ãƒ¼ã®IDã‚’ã“ã“ã«è¨­å®š
            "å¯’è‰²ç³»": "2a1c1f65e39880c28f01000c353bae14", // â† å¯’è‰²ç³»ãƒ“ãƒ¥ãƒ¼ã®URLã‹ã‚‰å–å¾—
            "æš–è‰²ç³»": "2a1c1f65e398800d9c2a000c7aedf618", // â† æš–è‰²ç³»ãƒ“ãƒ¥ãƒ¼ã®URLã‹ã‚‰å–å¾—
            "ã‚¾ãƒ¼ãƒ³è‰¯å¥½": "2a1c1f65e39880329729000cda2bd951", // â† ã‚¾ãƒ¼ãƒ³è‰¯å¥½ãƒ“ãƒ¥ãƒ¼ã®URLã‹ã‚‰å–å¾—
            "ä¸‰åˆ†å‰²": "2a1c1f65e398803b9e5f000c242a5231"
            // ... å¿…è¦ãªã‚¿ã‚°åˆ†è¿½åŠ 
        };
        // 2. Notionã®ã€Œã‚¿ã‚°/ã‚«ãƒ†ã‚´ãƒªã€ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®é¸æŠè‚¢ã‚’è¨­å®šã—ã¦ãã ã•ã„
        const NOTION_TAGS = [
            "å¯’è‰²ç³»",
            "æš–è‰²ç³»",
            "ã‚¾ãƒ¼ãƒ³è‰¯å¥½",
            "ä¸‰åˆ†å‰²"
        ];

        // 3. Notionã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹URLã®æœ«å°¾ã«ã‚ã‚‹ãƒ“ãƒ¥ãƒ¼IDã‚’è¨­å®šã—ã¦ãã ã•ã„
        const VIEW_ID = "5cbfc69b6d6a4eadbdae06703ffe9b4f"; 

        // =================================================================
        // æ–°ã—ã„ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ­ã‚¸ãƒƒã‚¯
        // =================================================================
        
        let currentView = 'view-1-category'; // ç¾åœ¨ã®ãƒ“ãƒ¥ãƒ¼ID
        let viewHistory = ['view-1-category']; // ç”»é¢å±¥æ­´ã‚¹ã‚¿ãƒƒã‚¯
        
        // ç”»é¢ã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹ãƒ¡ã‚¤ãƒ³é–¢æ•°
        function showView(viewName) {
            // ã™ã¹ã¦ã®ãƒ“ãƒ¥ãƒ¼ã‚’éè¡¨ç¤ºã«ã™ã‚‹
            document.getElementById('view-1-category').classList.add('hidden');
            document.getElementById('view-2-tag').classList.add('hidden');
            document.getElementById('view-3-embed').classList.add('hidden');
        
            // ç›®çš„ã®ãƒ“ãƒ¥ãƒ¼ã‚’è¡¨ç¤ºã™ã‚‹
            document.getElementById(viewName).classList.remove('hidden');
            currentView = viewName;
        
            // æˆ»ã‚‹ãƒœã‚¿ãƒ³ã®è¡¨ç¤º/éè¡¨ç¤ºã‚’åˆ¶å¾¡
            const backButton = document.getElementById('back-button');
            if (viewHistory.length > 1) {
                backButton.classList.remove('hidden');
            } else {
                backButton.classList.add('hidden');
            }
        }

        // æˆ»ã‚‹ãƒœã‚¿ãƒ³ã®å‡¦ç†
        function goBack() {
            if (viewHistory.length > 1) {
                // ç¾åœ¨ã®ç”»é¢ã‚’ã‚¹ã‚¿ãƒƒã‚¯ã‹ã‚‰ãƒãƒƒãƒ—
                viewHistory.pop();
                // 1ã¤å‰ã®ç”»é¢ã«æˆ»ã‚‹
                const prevView = viewHistory[viewHistory.length - 1];
        
                // æˆ»ã‚‹æ™‚ã¯å±¥æ­´ã«è¿½åŠ ã—ãªã„ã‚ˆã†ã« showView(prevView, false) ã®ã‚ˆã†ãª
                // å‡¦ç†ãŒå¿…è¦ã§ã™ãŒã€ã“ã“ã§ã¯ã‚·ãƒ³ãƒ—ãƒ«ã« showView ã‚’ä½¿ã„ã¾ã™ã€‚
                showView(prevView); 
            }
        }
        // =================================================================
        // ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ­ã‚¸ãƒƒã‚¯
        // =================================================================

        const iframeContainer = document.getElementById('iframe-container');
        const filterContainer = document.getElementById('category-filters');
        const viewContainer = document.getElementById('view-toggles');
        let currentTag = 'all'; 
        let currentView = 'grid'; 

    /**
    * NotionåŸ‹ã‚è¾¼ã¿URLã‚’ç”Ÿæˆã™ã‚‹
    * @returns {string} - Notionã®åŸ‹ã‚è¾¼ã¿URL
    */
       function generateNotionUrl() {
       // ã€ä¿®æ­£å¾Œã®ã‚³ãƒ¼ãƒ‰ã€‘ãƒ™ãƒ¼ã‚¹URLã¨ãƒ“ãƒ¥ãƒ¼IDã‚’ä½¿ç”¨
             let url = NOTION_BASE_URL;
           let queryParams = [];
           
           // 1. ç¾åœ¨é¸æŠã•ã‚Œã¦ã„ã‚‹ã‚¿ã‚°ã«å¯¾å¿œã™ã‚‹ãƒ“ãƒ¥ãƒ¼IDã‚’å–å¾—
           const targetViewId = VIEW_MAP[currentTag]; 
           
    // 2. ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãƒ“ãƒ¥ãƒ¼IDãŒå­˜åœ¨ã™ã‚Œã°ã€ãã‚Œã‚’URLã«è¿½åŠ 
           if (targetViewId) {
               // Notionã®ãƒ•ã‚£ãƒ«ã‚¿ã¯ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ 'v' ã§ãƒ“ãƒ¥ãƒ¼IDã‚’æ¸¡ã—ã¾ã™ã€‚
               queryParams.push(`v=${targetViewId}`);
           } else if (currentTag !== 'all') {
               console.error(`Error: View ID not found for tag: ${currentTag}`);
               // ã‚‚ã—IDãŒå®šç¾©ã•ã‚Œã¦ã„ãªã‘ã‚Œã°ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã«æˆ»ã‚‹ãªã©ã®å‡¦ç†ãŒã§ãã¾ã™ãŒã€
               // ã“ã“ã§ã¯ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã®ã¿å‡ºåŠ›ã—ã¾ã™ã€‚
           }
           
           // åŸ‹ã‚è¾¼ã¿ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆç¶­æŒï¼‰
           queryParams.push(`embed=true`);
           
           // ãƒ‡ãƒãƒƒã‚°æƒ…å ±ï¼ˆç¶­æŒï¼‰
           if (currentTag !== 'all' || currentView !== 'grid') {
               // æ³¨æ„ï¼šNotionã®åŸ‹ã‚è¾¼ã¿URLã¯ã“ã®ã‚«ã‚¹ã‚¿ãƒ ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆcustom_tag, custom_viewï¼‰ã‚’ç„¡è¦–ã—ã¾ã™ã€‚
               // ã“ã‚Œã¯ãƒ‡ãƒãƒƒã‚°ç”¨ã¨ã—ã¦ãã®ã¾ã¾æ®‹ã—ã¦ãŠãã¾ã™ã€‚
               queryParams.push(`custom_tag=${encodeURIComponent(currentTag)}`, `custom_view=${currentView}`);
           }
           
           if (queryParams.length > 0) {
               url += `?${queryParams.join('&')}`;
           }
           
           console.log("Loading URL:", url);
           return url;
       }
        /**
         * iframeã‚’å†æ§‹ç¯‰ã—ã¦Notionã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’èª­ã¿è¾¼ã‚€
         */
        function loadNotionIframe() {
            const url = generateNotionUrl();
            
            // æ—¢å­˜ã®iframeã‚’å‰Šé™¤
            iframeContainer.innerHTML = '';

            // æ–°ã—ã„iframeã‚’ä½œæˆ
            const iframe = document.createElement('iframe');
            iframe.id = 'notion-iframe';
            iframe.src = url;
            iframe.title = 'Notion Embedded Content';
            
ã€€ã€€ã€€ã€€ã€€ã€€ã€€// iframeã®sandboxå±æ€§ã«ä¸è¶³ã—ã¦ã„ã‚‹æ¨©é™ã‚’è¿½åŠ 
ã€€ã€€ã€€ã€€ã€€ã€€ã€€iframe.setAttribute(
    ã€€ã€€ã€€ã€€ã€€ã€€ã€€'sandbox',
   ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€'allow-scripts allow-same-origin allow-popups allow-forms allow-modals allow-pointer-lock allow-presentation allow-top-navigation-by-user-activation allow-downloads'
ã€€ã€€ã€€ã€€ã€€ã€€ã€€);
            
            iframeContainer.appendChild(iframe);
            
            console.log("Notion Iframe Loaded with URL:", url);
        }

        // ç¬¬1éšå±¤ã®ã‚«ãƒ†ã‚´ãƒªã‚¿ã‚¤ãƒ«ã‚’æç”»ã™ã‚‹é–¢æ•°
        function renderCategoryView() {
            const container = document.getElementById('view-1-category');
            container.innerHTML = ''; // åˆæœŸåŒ–

            for (const category in CATEGORY_MAP) {
                const data = CATEGORY_MAP[category];
        
                // âš¡ï¸ ã“ã“ã«ç¬¬1éšå±¤ï¼ˆä¾‹: ğŸ¨ è‰²ï¼‰ã®HTMLã‚¿ã‚¤ãƒ«ã‚’ç”Ÿæˆã—ã¾ã™
                // ã‚¿ã‚¤ãƒ«ã®ã‚¯ãƒªãƒƒã‚¯æ™‚ã«ã¯ goToCategory(category) ã‚’å‘¼ã³å‡ºã—ã¾ã™
                const tile = document.createElement('div');
                tile.className = 'p-6 bg-gray-700 rounded-lg shadow-lg cursor-pointer hover:bg-gray-600 transition';
                tile.innerHTML = `<h2 class="text-2xl font-semibold">${data.icon} ${category}</h2>`;
        
                // ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆã‚’è¨­å®š: ç¬¬2éšå±¤ã¸ç§»å‹•
                tile.onclick = () => goToCategory(category);
        
                container.appendChild(tile);
            }
            showView('view-1-category'); // ç”»é¢ã®åˆæœŸè¡¨ç¤º
        }

        /**
         * ãƒ•ã‚£ãƒ«ã‚¿ãƒœã‚¿ãƒ³ã®ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©
         */
        function handleFilterClick(event) {
            const target = event.target.closest('.filter-btn');
            if (!target) return;

            currentTag = target.dataset.tag;
            
            // ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã‚¯ãƒ©ã‚¹ã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹
            document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('btn-active'));
            target.classList.add('btn-active');

            // iframeã‚’å†èª­ã¿è¾¼ã¿
            loadNotionIframe(); 
        }

        /**
         * ãƒ“ãƒ¥ãƒ¼åˆ‡ã‚Šæ›¿ãˆãƒœã‚¿ãƒ³ã®ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©
         */
        function handleViewClick(event) {
            const target = event.target.closest('.view-btn');
            if (!target) return;

            currentView = target.dataset.view;
            
            // ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã‚¯ãƒ©ã‚¹ã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹
            document.querySelectorAll('.view-btn').forEach(btn => btn.classList.remove('btn-active'));
            target.classList.add('btn-active');
            
            // iframeã‚’å†èª­ã¿è¾¼ã¿
            loadNotionIframe();
        }

        // ãƒšãƒ¼ã‚¸ã®åˆæœŸåŒ–å‡¦ç†
        window.onload = function() {
            // ã‚«ãƒ†ã‚´ãƒªãƒœã‚¿ãƒ³ã®æç”»
            //renderCategoryFilters();
            
            // æœ€åˆã®URLã§iframeã‚’èª­ã¿è¾¼ã‚€ï¼ˆã™ã¹ã¦/ã‚°ãƒªãƒƒãƒ‰ï¼‰
            loadNotionIframe();

            // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã®è¨­å®š
            filterContainer.addEventListener('click', handleFilterClick);
            viewContainer.addEventListener('click', handleViewClick);
            
            // ã€é‡è¦ã€‘æœªè¨­å®šã®è­¦å‘Š
            if (NOTION_PAGE_ID === "YOUR_NOTION_PAGE_ID_HERE") {
                console.error("Notionã®ãƒšãƒ¼ã‚¸IDãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚JSå†…ã® NOTION_PAGE_ID ã‚’æ›´æ–°ã—ã¦ãã ã•ã„ã€‚");
            }
        };

        // ãƒšãƒ¼ã‚¸ãŒiframeå†…ã§å‹•ä½œã—ã¦ã„ã‚‹ã“ã¨ã‚’æ¤œçŸ¥ã™ã‚‹ãŸã‚ã®ç°¡æ˜“ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
        try {
            if (window.self !== window.top) {
                console.log("Running inside an iframe (Notion embed).");
            }
        } catch (e) {
            console.log("Cannot determine if running inside an iframe.");
        }
    </script>

</body>
</html>
